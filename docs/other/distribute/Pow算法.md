## PoW算法

----



1.`出现原因`：口新型拜占庭将军解决方法、PBFT算法尽管能达成一致，但是如果增加叛军的数量，那么这两个方法就无法再实现一致。

因此出现了`PoW算法`。PoW算法使得增加叛军，也就是叛徒节点的代价变得非常大。

区块链通过工作量证明（Proof of Work）增加了坏人作恶的成本，以此防止坏人作恶。比如，如果坏人要发起 51% 攻击，需要控制现网 51% 的算力，成本是非常高昂的。为啥呢？因为根据 Cryptoslate 估算，对比特币进行 51% 算力攻击需要上百亿人民币！

2.`PoW算法`：Proof of Work，工作量证明。简单理解：通过一份证明，来确认你认真完成了某件事，比如大学毕业证书，四六级证书等。

3.`类比到计算机的世界中`，验证的方法很简单：通过结果验证。

你说你完成了某件事，OK，那把计算结果发给我，我来验证你是否好好的完成了。

![image](https://tvax3.sinaimg.cn/large/0085EwgIgy1gtc5vedxlaj30nw07awfg.jpg)

4.`Hash Function`：区块链进行PoW验证的方法。

5.`Hash Function定义`:输入一个任意长度的字符串，哈
希函数会计算出一个长度相同的哈希值

6.`例子`：工作量要求是，基于一个基本的字符串（比如"geektime"），你可以在这个字符串后面添加一个整数值，然后对变更后（添加整数值) 的字符串进行 SHA256 哈希运算，如果运算后得到的哈希值（16 进制形式）是以"0000"开头的，就验证通过。为了达到这个工作量证明的目标，我们需要不停地递增整数值，一个一个试，对得到的新字符串进行 SHA256 哈希运算。按照这个规则，我们需要经过 35024 次计算，才能找到恰好前 4 位为 0 的哈希值

### 区块链如何实现PoW算法

1.`区块链的组成`：区块头 + 区块体。

![image](https://tva3.sinaimg.cn/large/0085EwgIgy1gtc64t53zvj30h50augn0.jpg)

2.`区块头`：上一个区块的Hash值，区块体的Hash值，随机数组成。

3.`区块体`：区块包含的交易数据。

4.`Hash函数的工作证明`：区块头固定长度为80字节，进行两次SHA256运算后得到的Hash值作为工作证明，计算出符合条件的哈希值后，矿工就会把这个信息广播给集群中所有其他节点，其他节点验证通过后，会将这个区块加入到自己的区块链中，最终形成一串区块链

![image](https://tvax2.sinaimg.cn/large/0085EwgIgy1gtc64t53zvj30h50augn0.jpg)

5.`区块链的接受原则`：一切以最长的区块链为准。如果攻击者的算力足够强大，就可以计算出比原链更长的攻击链，从而取代原链来达到财产损失的目的。

![image](https://tvax3.sinaimg.cn/large/0085EwgIgy1gtc692uqt2j30mv0dita3.jpg)

### 拜占庭与非拜占庭

PoW和PBFT算法属于拜占庭算法，允许部分叛徒，也能保证不出错。

而Raft则属于非拜占庭算法，如果出现叛徒，是不能保证一致的。

所以：

Raft一般用于封闭可信的环境中，主要用于封闭、绝对可信的场景中，比如私链、公司内网的 DevOps 环境；

拜占庭容错算法（比如 PoW 算法、PBFT 算法），能容忍一定比例
的作恶行为，所以它在相对开放的场景中应用广泛，比如公链、联盟链.