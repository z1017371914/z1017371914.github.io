### 两阶段提交协议

前提条件：

>1.集群分成了两部分：`协调者coordinator`，`事务参与者worker`.
>
>2.`协调者`只有一个，负责管理worker的事务提交
>
>3.`worker`有很多个，任意worker之间可通信，每个worker都有事务回滚的能力，先前的记录已经进行了持久化(写到磁盘)

实现过程：

>1.请求阶段：协调者通知worker表明自己是需要`提交事务`，还是`取消事务`.所有worker都会向协调者表明自己的决定
>
>2.提交阶段：协调者收到worker的决定，当且仅当所有的worker均为提交事务时，才会同意。否则命令所有worker进行回滚。

缺点：通过`阻塞`的完成协议。节点等待消息的时候是阻塞状态的，其他进程无法获取到CPU资源。

甚至，如果协调者宕机，那么就会永久的阻塞。