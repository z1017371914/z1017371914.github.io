## ChangeBuffer

1.`出现原因`：更新一个数据页时：

- 如果数据页在内存中，就可以直接更新
- 如果数据页没加载到内存中，InnoDB将更新操作缓存在`Change Buffer`中，当下次该页的内容加载到内存中时(比如查询)，就会将Change Buffer的改动写入到该页中；同时后台也会有线程定期的将change buffer的改动merge到磁盘中进行持久化

2.`使用场景`：只有`普通索引`可以使用change buffer。因为更新操作中，如果时唯一索引，需要先判断这个改动是否违反唯一性约束，这时候需要加载到内存中，既然已经加载到内存中，那必然不再需要change buffer，而是直接在内存中进行更改。

3.优点：在更新操作时，体现出了优点

- 使用唯一索引进行更新操作时，需要将数据页加载到内存中判断是否违反唯一性，这个操作不能使用change buffer，耗时较长
- 使用普通索引进行更新操作时，只需要将更新写入到change buffer，就算已经更改，耗时非常少

4.`使用场景`：在读少写多的业务场景，change bufffer能发挥最大的作用：不需要经常进行merge操作持久化到磁盘中，这样系统的响应速度是非常快的

